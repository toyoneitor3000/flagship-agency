(()=>{var e={};e.id=702,e.ids=[702],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},3743:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.ZP,__next_app__:()=>m,originalPathname:()=>c,pages:()=>d,routeModule:()=>x,tree:()=>o});var r=t(482),a=t(9108),n=t(3543),i=t(8300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(s,l);let o=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4003)),"C:\\Users\\camo1\\Documents\\flagship-agency\\src\\multiverse\\pigmentostkts-web\\src\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,4098)),"C:\\Users\\camo1\\Documents\\flagship-agency\\src\\multiverse\\pigmentostkts-web\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,2793)),"C:\\Users\\camo1\\Documents\\flagship-agency\\src\\multiverse\\pigmentostkts-web\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,8206)),"C:\\Users\\camo1\\Documents\\flagship-agency\\src\\multiverse\\pigmentostkts-web\\src\\app\\not-found.tsx"]}],d=["C:\\Users\\camo1\\Documents\\flagship-agency\\src\\multiverse\\pigmentostkts-web\\src\\app\\dashboard\\page.tsx"],c="/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},4400:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,1476,23)),Promise.resolve().then(t.bind(t,6010))},6010:(e,s,t)=>{"use strict";t.r(s),t.d(s,{OrderHistory:()=>i});var r=t(5344),a=t(1453),n=t(4339);function i({orders:e,isAdmin:s=!1}){let t=async(e,s)=>{try{(await fetch(`/api/orders/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})})).ok&&window.location.reload()}catch(e){console.error("Error updating status:",e)}};return 0===e.length?(0,r.jsxs)("div",{className:"p-12 text-center",children:[r.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",children:"\uD83D\uDECD️"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No hay pedidos a\xfan"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"\xa1Es hora de comprar algunos stickers incre\xedbles!"})]}):r.jsx("div",{className:"divide-y divide-gray-100",children:e.map((e,i)=>(0,r.jsxs)(n.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*i},className:"p-6 hover:bg-gray-50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Pedido #",e.id.slice(-6).toUpperCase()]}),r.jsx("p",{className:"text-xs text-gray-400",children:new Date(e.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})})]}),(0,r.jsxs)("div",{className:"mt-2 sm:mt-0 text-right",children:[s?(0,r.jsxs)("select",{value:e.status,onChange:s=>t(e.id,s.target.value),className:`text-xs font-bold px-3 py-1 rounded-full outline-none border-none transition-all cursor-pointer ${"COMPLETED"===e.status?"bg-green-100 text-green-800":"PENDING"===e.status?"bg-yellow-100 text-yellow-800":"CANCELLED"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[r.jsx("option",{value:"PENDING",children:"Procesando"}),r.jsx("option",{value:"PRODUCTION",children:"En Producci\xf3n"}),r.jsx("option",{value:"SHIPPED",children:"Enviado"}),r.jsx("option",{value:"COMPLETED",children:"Entregado"}),r.jsx("option",{value:"CANCELLED",children:"Cancelado"})]}):r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"COMPLETED"===e.status?"bg-green-100 text-green-800":"PENDING"===e.status?"bg-yellow-100 text-yellow-800":"CANCELLED"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:"COMPLETED"===e.status?"Entregado":"PENDING"===e.status?"Procesando":"PRODUCTION"===e.status?"En Producci\xf3n":"SHIPPED"===e.status?"Enviado":"CANCELLED"===e.status?"Cancelado":e.status}),r.jsx("p",{className:"text-lg font-bold text-brand-black mt-1",children:(0,a.T)(e.amount)})]})]}),r.jsx("div",{className:"space-y-4",children:e.items.map(e=>{let s=e.metadata?JSON.parse(e.metadata):null;return(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 py-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[r.jsx("div",{className:"h-14 w-14 rounded-xl bg-brand-yellow/10 flex items-center justify-center overflow-hidden border border-brand-yellow/20 shrink-0",children:e.product?.image?r.jsx("img",{src:e.product.image,alt:e.product?.name,className:"object-cover w-full h-full"}):r.jsx("span",{className:"text-xl",children:"\uD83C\uDFA8"})}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-bold text-gray-900",children:e.product?.name||s?.materialName||"Sticker Personalizado"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-x-3 gap-y-1 mt-0.5",children:[(0,r.jsxs)("p",{className:"text-[10px] text-gray-500 font-medium",children:["Cant: ",e.quantity]}),s?.dimensions&&r.jsx("p",{className:"text-[10px] text-brand-black font-bold uppercase",children:s.dimensions}),s?.cutTypeName&&r.jsx("p",{className:"text-[10px] bg-gray-100 px-1.5 py-0.5 rounded text-gray-600 font-bold uppercase",children:s.cutTypeName})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between sm:justify-end gap-4 border-t sm:border-0 pt-2 sm:pt-0",children:[r.jsx("p",{className:"text-sm font-black text-gray-900",children:(0,a.T)(e.price*e.quantity)}),e.fileUrl&&r.jsx("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"bg-brand-black text-white text-[10px] font-black px-3 py-1.5 rounded-lg hover:bg-brand-yellow hover:text-black transition-all uppercase tracking-tight",children:"Ver Dise\xf1o"})]})]},e.id)})})]},e.id))})}},4003:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(5036),a=t(1147),n=t(867),i=t(9631),l=t(6843);let o=(0,l.createProxy)(String.raw`C:\Users\camo1\Documents\flagship-agency\src\multiverse\pigmentostkts-web\src\components\dashboard\OrderHistory.tsx`),{__esModule:d,$$typeof:c}=o;o.default;let m=(0,l.createProxy)(String.raw`C:\Users\camo1\Documents\flagship-agency\src\multiverse\pigmentostkts-web\src\components\dashboard\OrderHistory.tsx#OrderHistory`);var x=t(6274);async function u(){let e=await (0,a.I8)();e?.user?.email||(0,n.redirect)("/api/auth/signin");let s="ADMIN"===e.user.role,t=await i.Z.order.findMany({where:s?{}:{user:{email:e.user.email}},include:{items:{include:{product:!0}},user:!0},orderBy:{createdAt:"desc"}});return r.jsx("div",{className:"min-h-screen bg-brand-gray pt-24 pb-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-brand-black tracking-tight",children:s?"Panel de Administraci\xf3n":"Mi Cuenta"}),r.jsx("p",{className:"text-gray-600 mt-1",children:s?"Gestionando todos los pedidos de la plataforma":`Bienvenido de vuelta, ${e.user.name||"Usuario"}`})]}),r.jsx(x.default,{href:"/",className:"text-sm font-medium text-brand-black hover:text-brand-yellow transition-colors",children:"← Volver a la tienda"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsx("div",{className:"p-6 border-b border-gray-100",children:r.jsx("h2",{className:"text-xl font-semibold text-brand-black",children:"Historial de Pedidos"})}),r.jsx(m,{orders:t,isAdmin:s})]})]})})}},1147:(e,s,t)=>{"use strict";t.d(s,{I8:()=>m,handlers:()=>o});var r=t(5718),a=t(7579),n=t(3764),i=t(5822),l=t(9631);let{handlers:o,signIn:d,signOut:c,auth:m}=(0,r.ZP)({providers:[a.Z,n.Z],adapter:(0,i.N)(l._),session:{strategy:"jwt"},pages:{signIn:"/auth/signin"},callbacks:{session:async({session:e,token:s})=>(s.sub&&e.user&&(e.user.id=s.sub,e.user.role=s.role),e),async jwt({token:e}){if(!e.sub)return e;let s=await l._.user.findUnique({where:{id:e.sub}});return s&&(e.role=s.role),e},authorized:({auth:e,request:{nextUrl:s}})=>(e?.user,!0)}})},9631:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n,_:()=>a});let r=require("@prisma/client"),a=global.prisma||new r.PrismaClient,n=a}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[638,402,378,867,134,787],()=>t(3743));module.exports=r})();